---
title: "HackTheBox - Cicada"
date: 2025-10-02 15:42:59 -0700
categories: [ctf, htb, RedOps, writeup]
tags: [windows, easy, active directory]
---
# Initial Intel
* Difficulty: Easy
* OS: Windows
* Active Directory

# TL;DR
<details><summary>Spoilers</summary>

</details>


# Attack Path
## Recon
### Service Enumeration

```bash
# set host & initiate a standard tcp scan
export cicada=10.10.11.35
sudo nmap -A -p- -vvv -T3 --open -oN nmap_tcp_full $cicada
```

```bash
# Services
53/tcp - domain - Simple DNS Plus
88/tcp - kerberos-sec - Microsoft Windows Kerberos
135/tcp - msrpc - Microsoft Windows RPC
139/tcp - netbios-ssn - Microsoft Windows netbios-ssn
389/tcp - ldap - Microsoft Windows Active Directory LDAP
445/tcp - microsoft-ds?
464/tcp - kpasswd5?
636/tcp - ssl/ldap - Microsoft Windows Active Directory LDAP
3268/tcp - ldap - Microsoft Windows Active Directory LDAP
3269/tcp - ssl/ldap - Microsoft Windows Active Directory LDAP
5985/tcp - http - Microsoft HTTPAPI httpd 2.0
```

#### SMB Enumeration

```bash
enum4linux-ng -A $cicada
.
.
.
Supported dialects:
  SMB 1.0: false
  SMB 2.02: true
  SMB 2.1: true
  SMB 3.0: true
  SMB 3.1.1: true
.
.
.
[+] Found domain information via SMB
NetBIOS computer name: CICADA-DC
NetBIOS domain name: CICADA
DNS domain: cicada.htb
FQDN: CICADA-DC.cicada.htb
Derived membership: domain member
Derived domain: CICADA
.
.
.
```

LDAP was our first hint this was a DC, and we've confirmed the FQDN here. It's always good practice to add the hostname to our hosts file as soon as we can to continue recon.

```bash
add-host $cicada CICADA-DC.cicada.htb

ping cicada-dc.cicada.htb
```

Now we try to further enermate SMB by checking share access:

```bash
# try guest access
nxc smb $cicada -u 'guest' -p '' -M spider_plus
.
.
.
SMB         10.10.11.35     445    CICADA-DC        Share           Permissions     Remark
SMB         10.10.11.35     445    CICADA-DC        -----           -----------     ------
SMB         10.10.11.35     445    CICADA-DC        ADMIN$                          Remote Admin
SMB         10.10.11.35     445    CICADA-DC        C$                              Default share
SMB         10.10.11.35     445    CICADA-DC        DEV                             
SMB         10.10.11.35     445    CICADA-DC        HR              READ            
SMB         10.10.11.35     445    CICADA-DC        IPC$            READ            Remote IPC
SMB         10.10.11.35     445    CICADA-DC        NETLOGON                        Logon server share 
SMB         10.10.11.35     445    CICADA-DC        SYSVOL                          Logon server share 
```

Guest can read two shares. HR looks promising.

```bash
# try to download all files from the HR share
smbclient "//$cicada/HR" -N -c "prompt OFF;recurse ON;mget *"
.
.
.
getting file \Notice from HR.txt of size 1266 as Notice from HR.txt (3.4 KiloBytes/sec) (average 3.4 KiloBytes/sec)
```

There was a file 'Noteice from HR.txt'. Let's check for intel.

```bash
cat 'Notice from HR.txt'
.
.
.
Your default password is: Cicada$M6Corpb*@Lp#nZp!8 
.
.
.
support@cicada.htb
.
.
.
```

Nice, we got a default password. We also got a support username. Let's try to get more usernames so we can try a password spray,



## Foothold

## Lateral Movement

## Privilege Escalation

## Root / SYSTEM

# Lessons Learned

